# Hyperledger elector

С помощью данного смарт контракта можно создавать анонимные голосования на базе платформы hyperledger-fabric

В системе существуют 2 основные роли: **админ** и **избиратель**.
**админ** может создавать и закрывать выборы
**избиратель** может голосовать

Просматривать результаты можно только после закрытия голосования. Роли - любые

## Особенности

### Система не требует регистрации пользователей

Идентификация и авторизирование пользователей происходят благодаря криптографическим алгоритмам
Администратор подписывает сообщение (далее сигнатура) в формате <название выборов>_<идентификатор пользователя>
Данная сигнатура подходит только для конкретного пользователя в конкретных выборах
Система Валидирует подписьи проверяет что она действительному принадлежит текущему пользователю

### Анонимное голосование

Голоса не хранят информацио о пользователе. Для предотвращения повторного голосования система сохраняет сигнатуру
отдельно от голоса и проверяет не использовалась ли она уже для этого голосования
Параметры голоса не фиксируются системой благодаря механизму transient data

## Основной сценарий работы

- Админ создает голосование
- Будущие избиратели предоставляют идентификационные данные сертификата выданного CA Hyperledger
- Админ подписывает сообщение формата  и отдает соответствующему избирателю
- Избиратель делает выбор и фиксирует его в системе
- После окончания голосования администратор закрывает его
- После закрытия голосования просмотр голосования становится доступным

## API

**ВАЖНО!** в дальнейшем первый аргумент функций contractapi.TransactionContextInterface и результирующий peer.Response будут упущены

### Для админа

NewElection(name string, candidates, nominations map[string]string)
Создание выбора

CloseElection(ctx contractapi.TransactionContextInterface, electionName string)
Закрытие выбора

Vote()
Голосование **Важно** данные передаются через transient data. Администратор не может голосовать

GetResults(electionName string)
Подсчет результатов. Доступны только после закрытия голосования. Не сохраняются в бч

GetElection(electionName string)
Получить инфу о выборах по имени. Не включает результаты

GetVotesCount(electionName string)
Суммарное количество голосов без доп инфы

## Тесты

```bash
go test ./...
```

### Полезные флаги

```bash
count=1 // отключить кэширование тестов
cover   // покрытие кода
```

### Html отчет о покрытий

```bash
go test ./... -count=1 -coverprofile=coverage.out
go tool cover -html=coverage.out
```
